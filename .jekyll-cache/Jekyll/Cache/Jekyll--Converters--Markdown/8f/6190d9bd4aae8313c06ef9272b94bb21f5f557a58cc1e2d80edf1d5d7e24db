I"§S<ul>
  <li>
    <p>10ì£¼ì°¨ ê³¼ì œ : MLP</p>

    <p><img src="https://user-images.githubusercontent.com/34560965/144801387-fc812211-9e36-4472-9dc8-56c00dca2559.png" alt="image" /></p>

    <ul>
      <li>ì‚¬ìš© ì–¸ì–´ : python</li>
      <li>í•´ê²° ë‚ ì§œ : 2021-12-06</li>
      <li>
        <p>ì½”ë“œ ì„¤ëª… :</p>

        <ul>
          <li>mnist ë°ì´í„°ë¥¼ ë‹¤ìš´ ë°›ì•„ ë¶ˆëŸ¬ì˜¨ í›„ 1, 5, 8 í´ë˜ìŠ¤ ë°ì´í„°ë§Œ ê°€ì§€ë„ë¡ ì¬êµ¬ì„±í•œë‹¤.</li>
          <li>ê·¸ í›„ ë°ì´í„°ë¥¼ train set : validation set : test set = 7 : 1 : 2 ê°€ ë˜ë„ë¡ ë‚˜ëˆˆë‹¤.</li>
          <li>ë‹¤ìŒìœ¼ë¡œ validationì„ setì„ ì´ìš©í•´ ê°€ì¥ ì¢‹ì€ ëª¨ë¸ì„ ê°€ì§€ë„ë¡, ë…¸ë“œì˜ ê°œìˆ˜ë¥¼ 10ì”© ëŠ˜ë ¤ê°€ë©° solverì˜ ì˜µì…˜ì€ â€œadam, sgdâ€, activation functionì˜ ì˜µì…˜ì€ â€œrelu, logistic(sigmoid)â€, ì€ë‹‰ì¸µ ìˆ˜ëŠ” â€œ2, 3â€ìœ¼ë¡œ ê²€ì¦í•œë‹¤. ì´ ê²½ìš°ì˜ ìˆ˜ëŠ” 80ê°œì´ë‹¤.</li>
          <li>ê·¸ ê²°ê³¼, ë…¸ë“œì˜ ê°œìˆ˜=90, solver=adam, activation function=relu, ì€ë‹‰ì¸µ ê°œìˆ˜=3ì¼ ë•Œì˜ validation ì •í™•ë„ê°€ 0.9938â€¦ìœ¼ë¡œ ê°€ì¥ ì¢‹ì€ ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¬ê³ , ì´ì— ë™ì¼í•œ ëª¨ë¸ì— train + validation setì„ í•™ìŠµí•˜ì—¬ test setìœ¼ë¡œ ë¶„ë¥˜ ì •í™•ë„ë¥¼ ì¸¡ì •í•œ ê²°ê³¼ 0.99000â€¦ìœ¼ë¡œ ì•½ 99%ì˜ ë¶„ë¥˜ ì •í™•ë„ë¥¼ ê°€ì§„ë‹¤.</li>
        </ul>
      </li>
      <li>
        <p>ê²°ê³¼ : 
  <img src="https://user-images.githubusercontent.com/34560965/144801390-03421e16-a86f-45ab-9c79-c05d34061e1a.png" alt="image" />
  <img src="https://user-images.githubusercontent.com/34560965/144801398-f9c8258a-2907-426d-9c06-f04d8c47b381.png" alt="image" />
  <img src="https://user-images.githubusercontent.com/34560965/144801403-7d3ce6a8-97fc-4d04-8f75-d9c25cadc725.png" alt="image" />
  <img src="https://user-images.githubusercontent.com/34560965/144801407-08e4f9a3-42bf-4603-8a19-0f9d94e7c6a1.png" alt="image" />
  <img src="https://user-images.githubusercontent.com/34560965/144801409-8f821ee2-036a-4c98-bde4-626d3d9026a7.png" alt="image" />
  <img src="https://user-images.githubusercontent.com/34560965/144801413-d0a8225d-b618-4d27-a387-8e23e76e4dee.png" alt="image" />
  <img src="https://user-images.githubusercontent.com/34560965/144801417-28380a60-7b2c-4cc8-9a5b-6269e07124aa.png" alt="image" />
  <img src="https://user-images.githubusercontent.com/34560965/144801425-5a328c51-d287-4337-93e6-ecb833d5445c.png" alt="image" />
  <img src="https://user-images.githubusercontent.com/34560965/144801427-52fb9029-6e88-47c4-9ae7-3130e51f00cb.png" alt="image" />
  <img src="https://user-images.githubusercontent.com/34560965/144801440-43751840-6708-4b01-84e4-28390053cf32.png" alt="image" />
  <img src="https://user-images.githubusercontent.com/34560965/144801449-c22bdba9-9dcb-4666-8890-8567633ad1e9.png" alt="image" />
  <img src="https://user-images.githubusercontent.com/34560965/144801451-e1fc1024-429e-4512-a438-0e33e1afd81f.png" alt="image" />
  <img src="https://user-images.githubusercontent.com/34560965/144801459-8f3671cc-5c2f-4b88-aa24-f03be43da3f2.png" alt="image" />
  <img src="https://user-images.githubusercontent.com/34560965/144801468-f988220d-b72d-4c3c-a916-67a2180584de.png" alt="image" /></p>
      </li>
      <li>
        <p>ì½”ë“œ</p>

        <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
</pre></td><td class="rouge-code"><pre>  <span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_openml</span>

  <span class="n">mnist</span> <span class="o">=</span> <span class="n">fetch_openml</span><span class="p">(</span><span class="s">'mnist_784'</span><span class="p">)</span>

  <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
  <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

  <span class="n">X</span> <span class="o">=</span> <span class="n">mnist</span><span class="p">.</span><span class="n">data</span>
  <span class="n">Y</span> <span class="o">=</span> <span class="n">mnist</span><span class="p">.</span><span class="n">target</span>

  <span class="c1"># 1,5,8 í´ë˜ìŠ¤ ë°ì´í„°ë§Œ ê°€ì§€ë„ë¡ êµ¬ì„±
</span>  <span class="n">data</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">Y</span><span class="o">==</span><span class="s">'1'</span><span class="p">,</span> <span class="n">Y</span><span class="o">==</span><span class="s">'5'</span><span class="p">),</span> <span class="n">Y</span><span class="o">==</span><span class="s">'8'</span><span class="p">)]</span>
  <span class="n">target</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">Y</span><span class="o">==</span><span class="s">'1'</span><span class="p">,</span> <span class="n">Y</span><span class="o">==</span><span class="s">'5'</span><span class="p">),</span> <span class="n">Y</span><span class="o">==</span><span class="s">'8'</span><span class="p">)]</span>

  <span class="c1"># train : validation : test = 7 : 1 : 2 ê°€ ë˜ë„ë¡ ë‚˜ëˆ”
</span>  <span class="n">train_x</span><span class="p">,</span> <span class="n">test_input</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">test_target</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
                                                              <span class="n">target</span><span class="p">,</span>
                                                              <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                                                              <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

  <span class="n">train_input</span><span class="p">,</span> <span class="n">val_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">val_target</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> 
                                                  <span class="n">train_y</span><span class="p">,</span> 
                                                  <span class="n">test_size</span><span class="o">=</span><span class="mf">0.125</span><span class="p">,</span> 
                                                  <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


  <span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPClassifier</span>
  <span class="kn">import</span> <span class="nn">mglearn</span>

  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
      <span class="n">j</span> <span class="o">=</span> <span class="n">i</span>
      <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
          <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
                
      <span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'adam'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
      <span class="n">mlp</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s">"ë…¸ë“œì˜ ê°œìˆ˜ê°€ {node}ì¼ ë•Œ ê²€ì¦ : {score}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">node</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">score</span> <span class="o">=</span> <span class="n">mlp</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">val_input</span><span class="p">,</span> <span class="n">val_target</span><span class="p">)))</span>

      <span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'adam'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
      <span class="n">mlp</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s">"ë…¸ë“œì˜ ê°œìˆ˜ê°€ {node}ì¼ ë•Œ ê²€ì¦ : {score}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">node</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">score</span> <span class="o">=</span> <span class="n">mlp</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">val_input</span><span class="p">,</span> <span class="n">val_target</span><span class="p">)))</span>

      <span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'adam'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'logistic'</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
      <span class="n">mlp</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s">"ë…¸ë“œì˜ ê°œìˆ˜ê°€ {node}ì¼ ë•Œ ê²€ì¦ : {score}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">node</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">score</span> <span class="o">=</span> <span class="n">mlp</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">val_input</span><span class="p">,</span> <span class="n">val_target</span><span class="p">)))</span>

      <span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'adam'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'logistic'</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
      <span class="n">mlp</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s">"ë…¸ë“œì˜ ê°œìˆ˜ê°€ {node}ì¼ ë•Œ ê²€ì¦ : {score}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">node</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">score</span> <span class="o">=</span> <span class="n">mlp</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">val_input</span><span class="p">,</span> <span class="n">val_target</span><span class="p">)))</span>
            
      <span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'sgd'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
      <span class="n">mlp</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s">"ë…¸ë“œì˜ ê°œìˆ˜ê°€ {node}ì¼ ë•Œ ê²€ì¦ : {score}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">node</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">score</span> <span class="o">=</span> <span class="n">mlp</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">val_input</span><span class="p">,</span> <span class="n">val_target</span><span class="p">)))</span>

      <span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'sgd'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
      <span class="n">mlp</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s">"ë…¸ë“œì˜ ê°œìˆ˜ê°€ {node}ì¼ ë•Œ ê²€ì¦ : {score}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">node</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">score</span> <span class="o">=</span> <span class="n">mlp</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">val_input</span><span class="p">,</span> <span class="n">val_target</span><span class="p">)))</span>

      <span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'sgd'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'logistic'</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
      <span class="n">mlp</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s">"ë…¸ë“œì˜ ê°œìˆ˜ê°€ {node}ì¼ ë•Œ ê²€ì¦ : {score}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">node</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">score</span> <span class="o">=</span> <span class="n">mlp</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">val_input</span><span class="p">,</span> <span class="n">val_target</span><span class="p">)))</span>

      <span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'sgd'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'logistic'</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
      <span class="n">mlp</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
      <span class="k">print</span><span class="p">(</span><span class="s">"ë…¸ë“œì˜ ê°œìˆ˜ê°€ {node}ì¼ ë•Œ ê²€ì¦ : {score}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">node</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">score</span> <span class="o">=</span> <span class="n">mlp</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">val_input</span><span class="p">,</span> <span class="n">val_target</span><span class="p">)))</span>


  <span class="n">final_mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'adam'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span>
  <span class="n">final_mlp</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="n">final_mlp</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_input</span><span class="p">,</span> <span class="n">test_target</span><span class="p">))</span>


</pre></td></tr></tbody></table></code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ul>
:ET