I"„5<ul>
  <li>
    <p>3ì£¼ì°¨ ê³¼ì œ : KNN-Classifier</p>

    <p><img src="https://user-images.githubusercontent.com/34560965/136653590-2d21b16a-feb5-4104-92d7-1a44912f5926.png" alt="image" />
  <img src="https://user-images.githubusercontent.com/34560965/136653594-499245f6-c508-4385-b557-89d9fccd1e91.png" alt="image" /></p>

    <ul>
      <li>ì‚¬ìš© ì–¸ì–´ : python</li>
      <li>
        <p>í•´ê²° ë‚ ì§œ : 2021-10-03</p>
      </li>
      <li>
        <p>ì½”ë“œ ì„¤ëª… :</p>

        <p>1)</p>
        <ul>
          <li>pandasì˜ read_csv í•¨ìˆ˜ë¡œ iris.csv íŒŒì¼ì„ ì½ì–´ì˜¤ê³ , 0~3ì—´ì˜ ê°’ë“¤ì€ dataë¡œ, 4ì—´ì˜ ê°’ë“¤ì€ targetìœ¼ë¡œ ì„¤ì •í•œë‹¤.</li>
          <li>KNeighborsClassfierë¡œ kì˜ ê°œìˆ˜ë¥¼ ì„¤ì •í•´ì£¼ê³ (1,5,10), training setê³¼ test setìœ¼ë¡œ 3:1ë¡œ ëœë¤í•˜ê²Œ ë‚˜ëˆˆ ë‹¤ìŒ í›ˆë ¨ ë°ì´í„°ë¥¼ ì´ìš©í•´ ëª¨ë¸ì„ í›ˆë ¨í•˜ê³ (kn.fit), í›ˆë ¨ëœ ëª¨ë¸ë¡œ ì •í™•ë„ë¥¼ ì¸¡ì •í•˜ì˜€ë‹¤(kn.score).</li>
          <li>ì´ ê²°ê³¼ K=1, 5, 10ì¼ ë•Œ ëª¨ë‘ ì •í™•ë„ëŠ” 0.973â€¦ë¡œ ëª¨ë‘ ë™ì¼í•˜ì˜€ë‹¤.</li>
        </ul>

        <p>2)</p>
        <ul>
          <li>1ë²ˆê³¼ ë§ˆì°¬ê°€ì§€ë¡œ pandasì˜ read_csv í•¨ìˆ˜ë¡œ iris_mod.csv íŒŒì¼ì„ ì½ì–´ì˜¤ê³ , 0~3ì—´ì˜ ê°’ë“¤ì€ dataë¡œ, 4ì—´ì˜ ê°’ë“¤ì€ targetìœ¼ë¡œ ì„¤ì •í•œë‹¤.</li>
          <li>normalization í•˜ê¸° ì „ì˜ í…ŒìŠ¤íŠ¸ ì…‘ì˜ ì •í™•ë„ëŠ” 1ë²ˆê³¼ ë™ì¼í•˜ê²Œ ì§„í–‰í•˜ì˜€ê³ , normalization ìˆ˜í–‰ í›„ í…ŒìŠ¤íŠ¸ ì…‘ì˜ ì •í™•ë„ëŠ” MinMaxScalerë¥¼ ì‚¬ìš©í•˜ì—¬ normalization ìˆ˜í–‰ í›„ ì¸¡ì •í•˜ì˜€ë‹¤.</li>
          <li>MinMaxScalerë¥¼ ì‚¬ìš©í•œ ì´ìœ ëŠ”, ì´ë²ˆ ê³¼ì œì—ì„œ ì£¼ì–´ì§„ iris_modê°€ ë°ì´í„°ê°€ ëª¨ì—¬ì ¸ ìˆê¸° ë³´ë‹¤ëŠ” ë„“ê²Œ ë¶„í¬ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ì‚¬ìš©í•˜ì˜€ë‹¤. ë°˜ëŒ€ë¡œ StandardScaler( (x â€“ í‰ê· ) / í‘œì¤€í¸ì°¨ )ëŠ” ëª¨ì—¬ì§„ ë°ì´í„°ì—ì„œ ì •í™•ë„ê°€ ë†’ê¸° ë•Œë¬¸ì— ì‚¬ìš©í•˜ì§€ ì•Šì•˜ë‹¤. ì •ê·œí™” ì§„í–‰ í›„ ì •í™•ë„ê°€ ì•½ 0.657ì—ì„œ 0.973ìœ¼ë¡œ ìƒë‹¹íˆ ë†’ì•„ì§„ ê²°ê³¼ë¥¼ ë³¼ ìˆ˜ ìˆì—ˆë‹¤.</li>
        </ul>
      </li>
      <li>
        <p>ì½”ë“œ</p>

        <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
</pre></td> --><td class="rouge-code"><pre>  <span class="c1"># In[131]:
</span>
  <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
  <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
  <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
  <span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>

  <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'C:/Users/rjsdu/OneDrive/ë°”íƒ• í™”ë©´/3-2/ê¸°ê³„í•™ìŠµ(ë°•ì •í¬ êµìˆ˜ë‹˜)/ê³¼ì œ/3ì£¼ì°¨/iris.csv'</span><span class="p">,</span> 
                  <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s">'Sepal length'</span><span class="p">,</span> <span class="s">'Sepal width'</span><span class="p">,</span> <span class="s">'Petal length'</span><span class="p">,</span> <span class="s">'Petal width'</span><span class="p">,</span> <span class="s">'Species'</span><span class="p">])</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">target</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

  <span class="n">kn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">train_input</span><span class="p">,</span> <span class="n">test_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">test_target</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">kn</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"K=1ì¼ ë•Œ í…ŒìŠ¤íŠ¸ ì…‘ì˜ ì •í™•ë„: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kn</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_input</span><span class="p">,</span> <span class="n">test_target</span><span class="p">)))</span>

  <span class="n">kn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
  <span class="n">train_input</span><span class="p">,</span> <span class="n">test_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">test_target</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">kn</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"K=5ì¼ ë•Œ í…ŒìŠ¤íŠ¸ ì…‘ì˜ ì •í™•ë„: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kn</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_input</span><span class="p">,</span> <span class="n">test_target</span><span class="p">)))</span>

  <span class="n">kn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
  <span class="n">train_input</span><span class="p">,</span> <span class="n">test_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">test_target</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">kn</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"K=10ì¼ ë•Œ í…ŒìŠ¤íŠ¸ ì…‘ì˜ ì •í™•ë„: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kn</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_input</span><span class="p">,</span> <span class="n">test_target</span><span class="p">)))</span>


  <span class="c1"># In[151]:
</span>

  <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
  <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
  <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
  <span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>

  <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'C:/Users/rjsdu/OneDrive/ë°”íƒ• í™”ë©´/3-2/ê¸°ê³„í•™ìŠµ(ë°•ì •í¬ êµìˆ˜ë‹˜)/ê³¼ì œ/3ì£¼ì°¨/iris_mod.csv'</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">target</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">kn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

  <span class="n">train_input</span><span class="p">,</span> <span class="n">test_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">test_target</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">kn</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"K=1ì¼ ë•Œ normalization ìˆ˜í–‰ ì „ í…ŒìŠ¤íŠ¸ ì…‘ì˜ ì •í™•ë„: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kn</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_input</span><span class="p">,</span> <span class="n">test_target</span><span class="p">)))</span>

  <span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
  <span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
  <span class="n">scaler</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
  <span class="n">train_input</span><span class="p">,</span> <span class="n">test_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">,</span> <span class="n">test_target</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">kn</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_input</span><span class="p">,</span> <span class="n">train_target</span><span class="p">)</span>
  <span class="k">print</span><span class="p">(</span><span class="s">"K=1ì¼ ë•Œ normalization ìˆ˜í–‰ í›„ í…ŒìŠ¤íŠ¸ ì…‘ì˜ ì •í™•ë„: "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kn</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_input</span><span class="p">,</span> <span class="n">test_target</span><span class="p">)))</span>

  <span class="c1"># from sklearn.preprocessing import StandardScaler
</span>  <span class="c1"># scaler = StandardScaler()
</span>  <span class="c1"># scaler.fit(data)
</span>  <span class="c1"># data = scaler.transform(data)
</span>  <span class="c1"># train_input, test_input, train_target, test_target = train_test_split(data, target, random_state=0)
</span>  <span class="c1"># kn.fit(train_input, train_target)
</span>  <span class="c1"># print("K=1ì¼ ë•Œ normalization ìˆ˜í–‰ í›„ í…ŒìŠ¤íŠ¸ ì…‘ì˜ ì •í™•ë„: " + str(kn.score(test_input, test_target)))
</span></pre></td></tr></tbody></table></code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ul>
:ET